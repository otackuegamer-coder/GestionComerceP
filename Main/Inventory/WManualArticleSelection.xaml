<Window x:Class="GestionComerce.Main.Inventory.WManualArticleSelection"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Sélection Manuelle des Articles" 
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="#F8FAFC">

    <Window.Resources>
        <SolidColorBrush x:Key="PrimaryBlue" Color="#3B82F6"/>
        <SolidColorBrush x:Key="AccentCyan" Color="#06B6D4"/>
        <SolidColorBrush x:Key="SuccessGreen" Color="#10B981"/>
        <SolidColorBrush x:Key="SurfaceWhite" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BorderLight" Color="#E2E8F0"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#0F172A"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#64748B"/>

        <DropShadowEffect x:Key="ShadowMd" BlurRadius="20" ShadowDepth="0" Color="#000000" Opacity="0.06"/>

        <Style x:Key="SearchBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#0F172A"/>
            <Setter Property="BorderBrush" Value="#E2E8F0"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="Height" Value="44"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10">
                            <Grid Margin="12,0">
                                <TextBlock x:Name="PlaceholderText"
                                           Text="{TemplateBinding Tag}"
                                           Foreground="#94A3B8"
                                           FontSize="14"
                                           VerticalAlignment="Center"
                                           IsHitTestVisible="False">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                                <ScrollViewer x:Name="PART_ContentHost" 
                                              Focusable="False"
                                              VerticalScrollBarVisibility="Hidden"
                                              Margin="0,8"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#3B82F6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryBlue}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="24,14"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="10"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#2563EB"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource SurfaceWhite}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderLight}"/>
            <Setter Property="Padding" Value="24,14"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F8FAFC"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CheckBoxStyle" TargetType="CheckBox">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
    </Window.Resources>

    <Grid Margin="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="24"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="16"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="24"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0">
            <StackPanel Orientation="Horizontal">
                <Path Data="M9 12H15M12 9V15M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                      Stroke="{StaticResource AccentCyan}"
                      StrokeThickness="2.5"
                      Width="32" Height="32"
                      Margin="0,0,16,0" 
                      Stretch="Fill"/>
                <TextBlock Text="Sélection Manuelle des Articles" 
                           FontSize="28" 
                           FontWeight="Bold"
                           Foreground="{StaticResource TextPrimary}"/>
            </StackPanel>
            <TextBlock Text="Choisissez les articles à inclure dans le devis" 
                       FontSize="14"
                       Foreground="{StaticResource TextSecondary}"
                       Margin="48,8,0,0"/>
        </StackPanel>

        <!-- Search and Actions Bar -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="12"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Category Filter ComboBox -->
            <ComboBox x:Name="CategoryFilterComboBox"
                      Grid.Column="0"
                      Height="44"
                      FontSize="14"
                      SelectionChanged="CategoryFilter_Changed">
                <ComboBox.ItemContainerStyle>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="Padding" Value="12,8"/>
                    </Style>
                </ComboBox.ItemContainerStyle>
            </ComboBox>

            <TextBox x:Name="SearchTextBox"
                     Grid.Column="2"
                     Style="{StaticResource SearchBoxStyle}"
                     Tag="🔍 Rechercher un article..."
                     TextChanged="SearchTextBox_TextChanged"/>

            <Button Grid.Column="4"
                    Content="✓ Tout sélectionner"
                    Width="180" Height="44"
                    Style="{StaticResource SecondaryButtonStyle}"
                    Click="SelectAll_Click"/>

            <Button Grid.Column="6"
                    Content="✕ Tout désélectionner"
                    Width="200" Height="44"
                    Style="{StaticResource SecondaryButtonStyle}"
                    Click="DeselectAll_Click"/>
        </Grid>

        <!-- Articles List -->
        <Border Grid.Row="4"
                Background="{StaticResource SurfaceWhite}"
                CornerRadius="16"
                BorderThickness="1"
                BorderBrush="{StaticResource BorderLight}"
                Effect="{StaticResource ShadowMd}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Stats Bar -->
                <Border Grid.Row="0"
                        Background="#EFF6FF"
                        BorderBrush="{StaticResource BorderLight}"
                        BorderThickness="0,0,0,1"
                        Padding="24,16">
                    <Grid>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📦 Total:" 
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,8,0"/>
                            <TextBlock x:Name="TotalArticlesText"
                                       Text="0"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource PrimaryBlue}"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBlock Text="✓ Sélectionnés:" 
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,8,0"/>
                            <TextBlock x:Name="SelectedCountText"
                                       Text="0"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource SuccessGreen}"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Scrollable List -->
                <ScrollViewer Grid.Row="1"
                              VerticalScrollBarVisibility="Auto"
                              Padding="24">
                    <StackPanel x:Name="ArticlesListPanel"/>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="6" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right">
            <Button Content="← Annuler"
                    Width="140" Height="48"
                    Style="{StaticResource SecondaryButtonStyle}"
                    Click="Cancel_Click"
                    Margin="0,0,12,0"/>
            <Button x:Name="ValidateButton"
                    Content="Valider la sélection →"
                    Width="220" Height="48"
                    Style="{StaticResource PrimaryButtonStyle}"
                    Click="Validate_Click">
                <Button.Background>
                    <SolidColorBrush Color="#10B981"/>
                </Button.Background>
            </Button>
        </StackPanel>
    </Grid>
</Window>